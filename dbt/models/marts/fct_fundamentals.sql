{{
  config(
    materialized="incremental",
    incremental_strategy="merge",
    unique_key=["inn", "year"],
    merge_update_columns=[
'inn', '"year"', '"1100"', '"1110"', '"1120"', '"1130"', '"1140"', '"1150"', '"1160"', '"1170"', '"1180"', '"1190"',
'"1200"', '"1210"', '"1220"', '"1230"', '"1240"', '"1250"', '"1260"', '"1300"', '"1310"', '"1320"', '"1340"', '"1350"',
'"1360"', '"1370"', '"1400"', '"1410"', '"1420"', '"1430"', '"1450"', '"1500"', '"1510"', '"1520"', '"1530"', '"1540"',
'"1550"', '"1600"', '"1700"', '"2100"', '"2110"', '"2120"', '"2200"', '"2210"', '"2220"', '"2300"', '"2310"', '"2320"',
'"2330"', '"2340"', '"2350"', '"2400"', '"2410"', '"2421"', '"2430"', '"2450"', '"2460"', '"2500"', '"2510"', '"2520"',
'"3200"', '"3300"', '"3310"', '"3311"', '"3312"', '"3313"', '"3314"', '"3315"', '"3316"', '"3320"', '"3321"', '"3322"',
'"3323"', '"3324"', '"3325"', '"3326"', '"3327"', '"3330"', '"3340"', '"3600"', '"4100"', '"4110"', '"4111"', '"4112"',
'"4113"', '"4119"', '"4120"', '"4121"', '"4122"', '"4123"', '"4124"', '"4129"', '"4200"', '"4210"', '"4211"', '"4212"',
'"4213"', '"4214"', '"4219"', '"4220"', '"4221"', '"4222"', '"4223"', '"4224"', '"4229"', '"4300"', '"4310"', '"4311"',
'"4312"', '"4313"', '"4314"', '"4319"', '"4320"', '"4321"', '"4322"', '"4323"', '"4329"', '"4400"', '"4490"', '"6100"',
'"6200"', '"6210"', '"6215"', '"6220"', '"6230"', '"6240"', '"6250"', '"6300"', '"6310"', '"6311"', '"6312"', '"6313"',
'"6320"', '"6321"', '"6322"', '"6323"', '"6324"', '"6325"', '"6326"', '"6330"', '"6350"', '"6400"', '"2411"', '"4450"',
'"4500"', '"2412"', '"3100"', '"3210"', '"3211"', '"3230"', '"3400"', '"3401"', '"3402"', '"3500"', '"3501"', '"3502"',
'"3220"', '"3221"', '"3410"', '"3411"', '"2900"', '"2910"', '"3213"', '"3227"', '"3223"', '"3420"', '"3421"', '"3240"',
'"3212"', '"3222"', '"2530"', '"3216"', '"3226"', '"3214"', '"3215"', '"3224"', '"3225"', '"3412"', '"3422"', '"date"',
'"type"']
  )
}}
WITH stg AS (
    SELECT
        inn,
        year,
        LAST_VALUE("1100") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1100",
        LAST_VALUE("1110") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1110",
        LAST_VALUE("1120") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1120",
        LAST_VALUE("1130") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1130",
        LAST_VALUE("1140") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1140",
        LAST_VALUE("1150") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1150",
        LAST_VALUE("1160") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1160",
        LAST_VALUE("1170") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1170",
        LAST_VALUE("1180") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1180",
        LAST_VALUE("1190") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1190",
        LAST_VALUE("1200") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1200",
        LAST_VALUE("1210") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1210",
        LAST_VALUE("1220") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1220",
        LAST_VALUE("1230") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1230",
        LAST_VALUE("1240") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1240",
        LAST_VALUE("1250") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1250",
        LAST_VALUE("1260") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1260",
        LAST_VALUE("1300") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1300",
        LAST_VALUE("1310") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1310",
        LAST_VALUE("1320") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1320",
        LAST_VALUE("1340") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1340",
        LAST_VALUE("1350") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1350",
        LAST_VALUE("1360") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1360",
        LAST_VALUE("1370") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1370",
        LAST_VALUE("1400") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1400",
        LAST_VALUE("1410") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1410",
        LAST_VALUE("1420") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1420",
        LAST_VALUE("1430") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1430",
        LAST_VALUE("1450") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1450",
        LAST_VALUE("1500") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1500",
        LAST_VALUE("1510") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1510",
        LAST_VALUE("1520") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1520",
        LAST_VALUE("1530") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1530",
        LAST_VALUE("1540") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1540",
        LAST_VALUE("1550") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1550",
        LAST_VALUE("1600") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1600",
        LAST_VALUE("1700") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "1700",
        LAST_VALUE("2100") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2100",
        LAST_VALUE("2110") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2110",
        LAST_VALUE("2120") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2120",
        LAST_VALUE("2200") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2200",
        LAST_VALUE("2210") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2210",
        LAST_VALUE("2220") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2220",
        LAST_VALUE("2300") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2300",
        LAST_VALUE("2310") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2310",
        LAST_VALUE("2320") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2320",
        LAST_VALUE("2330") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2330",
        LAST_VALUE("2340") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2340",
        LAST_VALUE("2350") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2350",
        LAST_VALUE("2400") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2400",
        LAST_VALUE("2410") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2410",
        LAST_VALUE("2421") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2421",
        LAST_VALUE("2430") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2430",
        LAST_VALUE("2450") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2450",
        LAST_VALUE("2460") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2460",
        LAST_VALUE("2500") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2500",
        LAST_VALUE("2510") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2510",
        LAST_VALUE("2520") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2520",
        LAST_VALUE("3200") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3200",
        LAST_VALUE("3300") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3300",
        LAST_VALUE("3310") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3310",
        LAST_VALUE("3311") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3311",
        LAST_VALUE("3312") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3312",
        LAST_VALUE("3313") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3313",
        LAST_VALUE("3314") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3314",
        LAST_VALUE("3315") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3315",
        LAST_VALUE("3316") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3316",
        LAST_VALUE("3320") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3320",
        LAST_VALUE("3321") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3321",
        LAST_VALUE("3322") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3322",
        LAST_VALUE("3323") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3323",
        LAST_VALUE("3324") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3324",
        LAST_VALUE("3325") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3325",
        LAST_VALUE("3326") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3326",
        LAST_VALUE("3327") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3327",
        LAST_VALUE("3330") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3330",
        LAST_VALUE("3340") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3340",
        LAST_VALUE("3600") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3600",
        LAST_VALUE("4100") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4100",
        LAST_VALUE("4110") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4110",
        LAST_VALUE("4111") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4111",
        LAST_VALUE("4112") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4112",
        LAST_VALUE("4113") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4113",
        LAST_VALUE("4119") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4119",
        LAST_VALUE("4120") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4120",
        LAST_VALUE("4121") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4121",
        LAST_VALUE("4122") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4122",
        LAST_VALUE("4123") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4123",
        LAST_VALUE("4124") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4124",
        LAST_VALUE("4129") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4129",
        LAST_VALUE("4200") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4200",
        LAST_VALUE("4210") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4210",
        LAST_VALUE("4211") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4211",
        LAST_VALUE("4212") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4212",
        LAST_VALUE("4213") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4213",
        LAST_VALUE("4214") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4214",
        LAST_VALUE("4219") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4219",
        LAST_VALUE("4220") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4220",
        LAST_VALUE("4221") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4221",
        LAST_VALUE("4222") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4222",
        LAST_VALUE("4223") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4223",
        LAST_VALUE("4224") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4224",
        LAST_VALUE("4229") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4229",
        LAST_VALUE("4300") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4300",
        LAST_VALUE("4310") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4310",
        LAST_VALUE("4311") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4311",
        LAST_VALUE("4312") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4312",
        LAST_VALUE("4313") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4313",
        LAST_VALUE("4314") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4314",
        LAST_VALUE("4319") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4319",
        LAST_VALUE("4320") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4320",
        LAST_VALUE("4321") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4321",
        LAST_VALUE("4322") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4322",
        LAST_VALUE("4323") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4323",
        LAST_VALUE("4329") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4329",
        LAST_VALUE("4400") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4400",
        LAST_VALUE("4490") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4490",
        LAST_VALUE("6100") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6100",
        LAST_VALUE("6200") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6200",
        LAST_VALUE("6210") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6210",
        LAST_VALUE("6215") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6215",
        LAST_VALUE("6220") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6220",
        LAST_VALUE("6230") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6230",
        LAST_VALUE("6240") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6240",
        LAST_VALUE("6250") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6250",
        LAST_VALUE("6300") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6300",
        LAST_VALUE("6310") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6310",
        LAST_VALUE("6311") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6311",
        LAST_VALUE("6312") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6312",
        LAST_VALUE("6313") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6313",
        LAST_VALUE("6320") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6320",
        LAST_VALUE("6321") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6321",
        LAST_VALUE("6322") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6322",
        LAST_VALUE("6323") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6323",
        LAST_VALUE("6324") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6324",
        LAST_VALUE("6325") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6325",
        LAST_VALUE("6326") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6326",
        LAST_VALUE("6330") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6330",
        LAST_VALUE("6350") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6350",
        LAST_VALUE("6400") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "6400",
        LAST_VALUE("2411") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2411",
        LAST_VALUE("4450") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4450",
        LAST_VALUE("4500") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "4500",
        LAST_VALUE("2412") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2412",
        LAST_VALUE("3100") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3100",
        LAST_VALUE("3210") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3210",
        LAST_VALUE("3211") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3211",
        LAST_VALUE("3230") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3230",
        LAST_VALUE("3400") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3400",
        LAST_VALUE("3401") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3401",
        LAST_VALUE("3402") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3402",
        LAST_VALUE("3500") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3500",
        LAST_VALUE("3501") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3501",
        LAST_VALUE("3502") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3502",
        LAST_VALUE("3220") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3220",
        LAST_VALUE("3221") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3221",
        LAST_VALUE("3410") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3410",
        LAST_VALUE("3411") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3411",
        LAST_VALUE("2900") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2900",
        LAST_VALUE("2910") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2910",
        LAST_VALUE("3213") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3213",
        LAST_VALUE("3227") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3227",
        LAST_VALUE("3223") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3223",
        LAST_VALUE("3420") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3420",
        LAST_VALUE("3421") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3421",
        LAST_VALUE("3240") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3240",
        LAST_VALUE("3212") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3212",
        LAST_VALUE("3222") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3222",
        LAST_VALUE("2530") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "2530",
        LAST_VALUE("3216") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3216",
        LAST_VALUE("3226") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3226",
        LAST_VALUE("3214") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3214",
        LAST_VALUE("3215") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3215",
        LAST_VALUE("3224") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3224",
        LAST_VALUE("3225") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3225",
        LAST_VALUE("3412") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3412",
        LAST_VALUE("3422") OVER (PARTITION BY inn, year ORDER BY reporting_year DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "3422",
        row_number() OVER(PARTITION BY inn, cast("year" AS INTEGER) ORDER BY cast(reporting_year AS INTEGER) DESC) AS rn
    FROM {{ ref("stg_girbo_fundamentals") }}
)
SELECT
    inn,
    cast("year" AS INTEGER) AS "year",
    "1100",
    "1110",
    "1120",
    "1130",
    "1140",
    "1150",
    "1160",
    "1170",
    "1180",
    "1190",
    "1200",
    "1210",
    "1220",
    "1230",
    "1240",
    "1250",
    "1260",
    "1300",
    "1310",
    "1320",
    "1340",
    "1350",
    "1360",
    "1370",
    "1400",
    "1410",
    "1420",
    "1430",
    "1450",
    "1500",
    "1510",
    "1520",
    "1530",
    "1540",
    "1550",
    "1600",
    "1700",
    "2100",
    "2110",
    "2120",
    "2200",
    "2210",
    "2220",
    "2300",
    "2310",
    "2320",
    "2330",
    "2340",
    "2350",
    "2400",
    "2410",
    "2421",
    "2430",
    "2450",
    "2460",
    "2500",
    "2510",
    "2520",
    "3200",
    "3300",
    "3310",
    "3311",
    "3312",
    "3313",
    "3314",
    "3315",
    "3316",
    "3320",
    "3321",
    "3322",
    "3323",
    "3324",
    "3325",
    "3326",
    "3327",
    "3330",
    "3340",
    "3600",
    "4100",
    "4110",
    "4111",
    "4112",
    "4113",
    "4119",
    "4120",
    "4121",
    "4122",
    "4123",
    "4124",
    "4129",
    "4200",
    "4210",
    "4211",
    "4212",
    "4213",
    "4214",
    "4219",
    "4220",
    "4221",
    "4222",
    "4223",
    "4224",
    "4229",
    "4300",
    "4310",
    "4311",
    "4312",
    "4313",
    "4314",
    "4319",
    "4320",
    "4321",
    "4322",
    "4323",
    "4329",
    "4400",
    "4490",
    "6100",
    "6200",
    "6210",
    "6215",
    "6220",
    "6230",
    "6240",
    "6250",
    "6300",
    "6310",
    "6311",
    "6312",
    "6313",
    "6320",
    "6321",
    "6322",
    "6323",
    "6324",
    "6325",
    "6326",
    "6330",
    "6350",
    "6400",
    "2411",
    "4450",
    "4500",
    "2412",
    "3100",
    "3210",
    "3211",
    "3230",
    "3400",
    "3401",
    "3402",
    "3500",
    "3501",
    "3502",
    "3220",
    "3221",
    "3410",
    "3411",
    "2900",
    "2910",
    "3213",
    "3227",
    "3223",
    "3420",
    "3421",
    "3240",
    "3212",
    "3222",
    "2530",
    "3216",
    "3226",
    "3214",
    "3215",
    "3224",
    "3225",
    "3412",
    "3422",
    CAST(NOW() AS VARCHAR) AS "date",
    0 AS "type"
FROM stg
WHERE rn = 1